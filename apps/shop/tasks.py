import datetimeimport timeimport requestsfrom decouple import configfrom django.db.models import Sum, Countfrom apps.shop.models import OrderModelfrom core.celery import app@app.taskdef send_statistics():    today = datetime.datetime.today()    year = today.year    month = today.month    filter_kwargs = {"date__year": year, "date__month": month}    filtered_orders = OrderModel.objects.filter(**filter_kwargs)    order_stats = filtered_orders.values("employee__id").annotate(        unique_clients=Count("client", distinct=True),        clients=Count("client"),        products_sum=Sum("products"),        prices_sum=Sum("price")    ).values("employee__id", "employee__full_name", "unique_clients", "clients", "products_sum", "prices_sum")    for stat in order_stats:        text = f'ID: {stat["employee__id"]}\n' \               f'Full Name: {stat["employee__full_name"]}\n' \               f'Unique Clients: {stat["unique_clients"]}\n' \               f'Clients: {stat["clients"]}\n' \               f'Products: {stat["products_sum"] or 0}\n' \               f'Summa: {stat["prices_sum"] or 0}\n'        requests.get(            f'https://api.telegram.org/bot{config("BOT_TOKEN")}/sendMessage?chat_id={config("STAT_CHANNEL")}&text={text}'        )        time.sleep(1)    return True